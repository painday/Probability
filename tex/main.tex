% 模板出处：https://zhuanlan.zhihu.com/p/379360037

\documentclass[12pt, a4paper, oneside]{book}
\usepackage{ctex}
\usepackage{amsmath, amsthm, amssymb, bm, graphicx, hyperref, mathrsfs}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=blue,      
    urlcolor=blue,
    citecolor=cyan,
}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usepackage{comment}
\usepackage{titlesec,titleps} % 添加 titlesec 宏包
\titleclass{\section}{straight} % 清除默认章节格式

% 章节格式统一设置
\titleformat{\section}[runin]
  {\normalfont\bfseries}
  {\thesection.}
  {-0.5em}
  {\quad}
  
\titleformat{\subsection}[runin]
  {\normalfont\bfseries}
  {\thesubsection.}
  {-0.3em}
  {\quad}

% 间距微调
\titlespacing*{\section}
  {0pt}
  {1.2ex plus 0.5ex minus 0.2ex}
  {0.3em}

\titlespacing*{\subsection}
  {15pt} % 二级标题增加缩进
  {0.8ex plus 0.3ex minus 0.1ex}
  {0.2em}

\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\thesubsection}{\arabic{section}\arabic{subsection}}

% 图编号格式调整
\numberwithin{figure}{section}

% 定理环境样式调整
\theoremstyle{definition}
\newtheorem{theorem}{定理}[section]
\newtheorem{lemma}[theorem]{引理}
\newtheorem{definition}[theorem]{定义}
\newtheorem{example}[theorem]{例}
\newtheorem{proposition}[theorem]{命题}

% 页眉页脚设置(来自于 titleps 宏包)
% 设置页眉为楷体
\newpagestyle{main}{
    \sethead{\kaishu \sectiontitle}{}{\kaishu \thepage}
}
\pagestyle{main}

\title{{\Huge{\textbf{测度与概率 Notes}}}}
\author{Liu Fuzhou}
\date{\today}
\linespread{1.5}






\begin{document}

\maketitle

\pagenumbering{roman}
\setcounter{page}{1}

%\begin{comment}
\begin{center}
    \Huge\textbf{前言}
\end{center}~\

要看偏微分方程，就要先看泛函分析. 要看泛函分析，就要先看实分析. 泛函分析和实分析对随机分析也是重要的. 无论如何也绕不开 $L^p$ 空间. 可见掌握实分析十分重要. 以前其实也看过这个主题的书，结果后来都忘了. 看来做一些有形的笔记是很有必要的. 不需要特别详细，提纲挈领即可.

主要参考文献：
\begin{enumerate}
\item[1.] 近代概率引论:测度、鞅和随机微分方程. 袁震东. 科学出版社, 1991.
\item[2.] 测度与概率教程. 任佳刚,巫静. 科学出版社, 2018.
\item[3.] Measure, Integration \& Real Analysis. Sheldon Axler. Springer, 2020.
\end{enumerate}

~\\
\begin{flushright}
    \begin{tabular}{c}
        Liu Fuzhou\\
        \today
    \end{tabular}
\end{flushright}
%\end{comment}

\newpage
\pagenumbering{Roman}
\setcounter{page}{1}
\tableofcontents
\newpage
% 生成图表目录
\listoffigures
\newpage
\setcounter{page}{1}
\pagenumbering{arabic}


\section{集列的极限}
首先比较重要的概念就是集列的上极限与下极限. 集列 $\{A_n\}_{n\in\mathbb N}$ 的上极限就是落到其中无限多个集合的元素所做成的集合，也即 $\limsup_{n\to\infty}A_n=\bigcap_{n=1}^\infty\bigcup_{k=n}^\infty A_k.$ 
下极限就是除去有限多个集合后，落到所有集中的元素所做成的集合，也即 $\liminf_{n\to\infty}A_n=\bigcup_{n=1}^\infty\bigcap_{k=n}^\infty A_k.$ 换言之也即“最终落到集列” $A_n$ 中的那些元素之全体.
显然，下限集中的元素也都落到上限集之中，也即 $\liminf A_n\subset \limsup A_n.$ 如果集列 $A_n$ 的上限集与下限集相等，那么就说集列 $A_n$ 收敛，并称 $A=\liminf A_n=\limsup A_n$ 为集列 $A_n$ 的极限. 这个极限是关于集合包含的偏序关系说的. 
与实数的情况类似，有单调集列的收敛定理：如果 $A_n\uparrow$ 是单调递增的，那么 $\lim A_n=\bigcup_n A_n.$ 类似地，如果 $A_n\downarrow$ 是单调递减的，那么 $\lim A_n=\bigcap_n A_n.$ 


\begin{example}
    设 $\{A_n\}_{n\in\mathbb N}$ 为单调减少集列. 证明 
    \begin{equation*}
        A_1=\sum_{n=1}^\infty (A_n-A_{n+1}) + \bigcap_{n=1}^\infty A_n
    \end{equation*}
\end{example}
\begin{proof}
首先，右边的每个集合都含于 $A_1.$ 因此右边含于 $A_1.$ 其次，若 $x\in A_1$ 且 $x\notin \bigcap_{n=1}^\infty A_n$, 则 $x\in \sum_{n=1}^\infty (A_n-A_{n-1})$ 且 $x\notin \bigcap_{n=1}^\infty A_n.$ 因此 $A_1$ 也是单调递减的. 最后，若 $x\in \bigcap_{n=1}^\infty A_n$, 则存在某个 $n>1,$ 使得 $x\notin A_n.$ 令 $n_0$ 为最小的这种 $n,$ 那么就有 $x\notin A_{n_0},\ x\in A_{n_0-1}.$ 于是就有 $x\in \sum_{n=1}^\infty (A_n-A_{n-1}).$ 这就证明了 
$A_1\subset \sum_{n=1}^\infty (A_n-A_{n+1}) + \bigcap_{n=1}^\infty A_n.$ 
\end{proof}

\section{Riemann 积分} 
还是用 \cite{Axler_2020} 作为参考书比较好，还是彩色的. 我还是比较喜欢 Riemann 积分的，最开始是在梅加强的书上学的. 比较重要的技术就是证明 Darboux 上和总是大于等于 Darboux 下和那里，需要用到两个 partition 的 merge. 也就是说，用到了有界闭区间的 partition 全体构成一个 directed set 的性质. Darboux 上和与 Darboux 下和之差就是所谓的函数振幅 
$\Omega_\mathcal P (f)=\sum_{i} (\sup_{x_{i-1}\leq x\leq x_i} f-\inf_{x_{i-1}\leq x\leq x_i})(x_i-x_{i-1}),$ 这里 $\mathcal P=\{a=x_0<x_1<\cdots<x_n=b\}$ 是所讨论的具体的分割. 

如果向 partition 的点集增加元素，也即使得分割变得更细，那么结果就是上和不增，下和不减. 这就导致了两个极限 $\lim_{\mathcal P} \mathcal L(f,\mathcal P,[a,b])$ 和 $\lim_{\mathcal P} \mathcal U(f,\mathcal P,[a,b]),$ 称为 Riemann 下积分 $\underline{\int}$ 和上积分 $\overline{\int}$. 这两个极限是关于 partition 全体所具有的 directed set 结构说的, 也就是说是 net 的极限. 由于下和不大于上和，也即 $\mathcal L\leq \mathcal U,$ 因此这两个极限之间也有关系
\begin{equation}
    \underline{\int}_a^b f(x)\ \mathrm dx\leq  \overline{\int}_a^b f(x)\ \mathrm dx
\end{equation}
如果 Riemann 上下积分相等，就说 $f$ 在 $[a,b]$ 上 Riemann 可积，其积分 $\int_a^b f(x)\ \mathrm dx$ 就定义为上下积分的共同值. 

任意分割 $\mathcal P$ 都将区间 $[a,b]$ 分成 $\#(\mathcal P)-1$ 个首尾相接的闭区间 $[x_0,x_1],\cdots,[x_{n-1},x_n].$ 从每个闭区间挑选一个元素出来，就可以做成一个集合 $\Delta.$ 这种挑选当然是不唯一的. 称这种通过在每个闭区间中挑出一个元素所形成的集合为与 partition $\mathcal P$ 相伴的一个点集. 
设 $\{\mathcal P_n\}_{n\in\mathbb N}$ 是任意一列 partition, 并且 $\{\Delta_n\}_{n\in\mathbb N}$ 是一列与之相伴的点集，每个 $\Delta_n$ 中元素形如 $\Delta_n=\{\xi_1,\cdots,\xi_{\#(\mathcal P_n)-1}\},$ 那么就可以考虑 Riemann 和所形成的数列
\begin{equation}
    \mathcal R_n:=\mathcal R(f,\mathcal P_n,\Delta_n,[a,b])=\sum_{i=1}^{\#(\mathcal P_n)-1} f(\xi_i)(x_{i}-x_{i-1})
\end{equation}
显然有 $\mathcal L(f,\mathcal P_n,[a,b])\leq \mathcal R_n\leq \mathcal U(f,\mathcal P_n,[a,b]).$ 因此有
\begin{equation}\label{eq:Riemann limit inequalities}
    \underline{\int}_a^b f(x)\ \mathrm dx\leq \liminf \mathcal R_n\leq \limsup \mathcal R_n\leq  \overline{\int}_a^b f(x)\ \mathrm dx
\end{equation}

这就表明，如果 $\mathcal R_n$ 有收敛子列的话，那么该子列的极限就必定位于上下积分之间.  当然了，如果 $f$ 是 Riemann 可积的，这个极限就必定等于 $\int_a^b f(x)\ \mathrm dx.$ 


以上讨论了利用 partition 的全体所组成的集合之上的 directed set 结构来定义的 Riemann 积分. 下面考虑利用 Riemann 和关于 partition 的 mesh 的极限的途径. 这就是说，把 Riemann 积分定义为极限
\begin{equation}\label{eq:Riemann_limit}
    \lim_{\|\mathcal P\|\to 0} \mathcal R(f,\mathcal P,\Delta,[a,b])
\end{equation}
其中 $\|\mathcal P\|=\max_{i}|x_{i}-x_{i-1}|$ 是 partition 的 mesh. 这个极限其实相当强，因为其定义只涉及 partition, 对相伴的点集 $\Delta$ 没什么要求.  

由不等式 \eqref{eq:Riemann limit inequalities} 可知，如果两种定义下的 Riemann 积分均存在，那么它们的值必定相等. 因此，两种定义的等价性的证明就归结于证明其存在性的等价性.


要证明两种定义的等价性，首先要注意到，上下积分之差恰好等于函数振幅的下确界 $\inf_{\mathcal P}\Omega_\mathcal P(f).$ 这就是说 $\lim_{\mathcal P} (\mathcal U(f,\mathcal P,[a,b])-\mathcal L(f,\mathcal P,[a,b]))=\inf_{\mathcal P}\Omega_\mathcal P(f),$ 或者说 $\lim_{\mathcal P}\Omega_\mathcal P(f)=\inf_{\mathcal P}\Omega_\mathcal P(f).$ 
事实上，设 $\varepsilon>0,$ 那么由 net 的极限的定义，存在 partition $\mathcal P_0,$ 使得任意细于 $\mathcal P_0$ 的分割 $\mathcal P$ 都满足 $|\Omega_{\mathcal P_0}(f)-\lim_{\mathcal P} \Omega_{\mathcal P}(f)|<\varepsilon.$ 
另一方面，由下确界的定义，存在 partition $\mathcal P_1$ 使得 $\Omega_{\mathcal P_1}(f)< \inf_{\mathcal P}\Omega_{\mathcal P}(f)+\varepsilon.$
取分割 $\mathcal P_2$ 为 $\mathcal P_0$ 与 $\mathcal P_1$ 的 merge, 那么就有 
\begin{equation}
    \lim_{\mathcal P}\Omega_{\mathcal P}(f)-\varepsilon< \Omega_{\mathcal P_2}(f)\leq \Omega_{\mathcal P_1}(f)<\inf_{\mathcal P}\Omega_{\mathcal P}(f)+\varepsilon
\end{equation}
于是 $\inf_{\mathcal P}\Omega_{\mathcal P}(f)\leq \lim_{\mathcal P}\Omega_{\mathcal P}(f)<\inf_{\mathcal P}\Omega_{\mathcal P}(f)+2\varepsilon.$ 这就证明了 
\begin{equation}
    \overline{\int}_a^b f(x)\ \mathrm dx - \underline{\int}_a^b f(x)\ \mathrm dx = \inf_{\mathcal P}\Omega_{\mathcal P}(f)
\end{equation}

假如极限 \eqref{eq:Riemann_limit} 存在，其值记为 $A,$ 那么对于任意的 $\varepsilon>0,$ 存在 $\delta>0,$ 使得只要 partition 的 mesh 小于 $\delta,$ 就有 $|\mathcal R(f,\mathcal P,\Delta,[a,b])-A|<\varepsilon.$ 
现在固定分割 $\mathcal P,$ 那么由于该不等式对于任意与 $\mathcal P$ 相伴的点集 $\Delta$ 都成立，因此有 $\Omega_{\mathcal P}(f)\leq 2\varepsilon.$ 这就证明了 $\inf_{\mathcal P}\Omega_{\mathcal P}(f)=0,$ 因而上下积分相等. 

反之，要从上下积分相等导出极限 \eqref{eq:Riemann_limit} 的存在性，还需要证明一个基于 partition 的 mesh 估计的技术性引理：
\begin{lemma}\label{lemma:mesh estimate}
    设 $\mathcal P,\mathcal P'$ 为区间 $[a,b]$ 的两个 partition, $M=\sup_{x\in [a,b]}|f(x)|,$ 那么就有不等式 
    \begin{equation}\label{eq:mesh estimate}
        \Omega_{\mathcal P}(f) \leq \Omega_{\mathcal P'}(f) + (\#(\mathcal P')-2)M\|\mathcal P\|
    \end{equation}
\end{lemma}

事实上，如果向 $\mathcal P$ 中添加一个新元素 $y,$ 譬如说插入到区间 $[x_k,x_{k+1}]$ 中，那么所形成的新分割 $\mathcal P''$ 的 Darboux 和与 $\mathcal P$ 的 Darboux 的差异仅来自于区间 $[x_k,x_{k+1}]$ 的贡献，也即
\begin{equation}
    \Omega_{\mathcal P''}(f)-\Omega_{\mathcal P}(f)=\omega_{x_k\leq x\leq y}f(x) (y-x_k)+ \omega_{y\leq x\leq x_{k+1}}f(x) (x_{k+1}-y) - \omega_{x_k\leq x\leq x_{k+1}}f(x) (x_{k+1}-x_k)
\end{equation}
考虑到 $\omega_{x_k\leq x\leq y}-\omega_{x_k\leq x\leq x_{k+1}}$ 和 $\omega_{y\leq x\leq x_{k+1}}-\omega_{x_k\leq x\leq x_{k+1}}$ 都落到区间 $[-M,M]$ 内，因此 $\Omega_{\mathcal P''}(f)-\Omega_{\mathcal P}(f)$ 的绝对值被 $M(x_{k+1}-x_k)$ 控制， 
从而也被 $M\|\mathcal P\|$ 控制. 这就导出了 $|\Omega_{\mathcal P''}(f)-\Omega_{\mathcal P}(f)|\leq M\|\mathcal P\|.$ 类似地，如果向 $\mathcal P''$ 中再插入一个新元素得到新分割 $\mathcal P''',$那么同样有
\begin{equation}
    |\Omega_{\mathcal P'''}(f)-\Omega_{\mathcal P''}(f)|\leq M\|\mathcal P''\|
\end{equation}
由于 $\mathcal P'''$ 细于 $\mathcal P,$ 因此 $\|\mathcal P'''\|\leq \|\mathcal P\|.$ 因此 $\Omega_{\mathcal P'''}(f)-\Omega_{\mathcal P''}(f)$ 的绝对值也被 $M\|\mathcal P\|$ 控制，从而有 $|\Omega_{\mathcal P'''}(f)-\Omega_{\mathcal P}(f)|\leq 2 M\|\mathcal P\|.$ 
现在考虑 $\mathcal P$ 与 $\mathcal P'$ 的 merge $\mathcal S,$ 其可以通过反复向 $\mathcal P$ 中插入元素来得到，插入次数至多为 $ \#(\mathcal P')-2$ 次. 因此就有
\begin{equation}
    \Omega_{\mathcal P}(f)-(\#(\mathcal P')-2)M\|\mathcal P\|\leq \Omega_{\mathcal S}(f)\leq \Omega_{\mathcal P'}(f)
\end{equation}
这就导出了不等式 \eqref{eq:mesh estimate}. 这个引理最初是在 \cite{Mei_2011} pp.213 看到的.

作为引理 \ref{lemma:mesh estimate} 的一个推论，立刻可以导出
\begin{equation}\label{eq:Riemann_limit_mesh_inf}
    \lim_{\|\mathcal P\|\to 0} \Omega_{\mathcal P}(f)=\inf_{\mathcal P}\Omega_{\mathcal P}(f)
\end{equation}
这是因为，设 $\varepsilon>0,$ 那么由下确界的定义可知存在 partition $\mathcal P_0,$ 使得 $\Omega_{\mathcal P_0}(f)<\inf_{\mathcal P}\Omega_{\mathcal P}(f)+\varepsilon.$ 
记 $N=\#(\mathcal P_0)-2,$ 那么当 partition 的 mesh 小于 $\varepsilon/(MN)$ 时，由引理 \ref{lemma:mesh estimate} 可知
\begin{equation}
    \Omega_{\mathcal P}(f)\leq\Omega_{\mathcal P_0}(f)+(\#(\mathcal P')-2)M\|\mathcal P\|<\inf_{\mathcal P}\Omega_{\mathcal P}(f)+2\varepsilon
\end{equation}
这就证明了 \eqref{eq:Riemann_limit_mesh_inf} 式. 类似地可以证明
\begin{equation}\label{eq:Riemann_limit_mesh_upper_lower}
    \lim_{\|\mathcal P\|\to 0} \mathcal L(f,\mathcal P,[a,b])=\underline{\int}_a^b f(x)\ \mathrm dx,\ \lim_{\|\mathcal P\|\to 0} \mathcal U(f,\mathcal P,[a,b])=\overline{\int}_a^b f(x)\ \mathrm dx.
\end{equation}

现在假设 Riemann 上下积分相等，也即 $\lim_{\|\mathcal P\|\to 0}\Omega_{\mathcal P}(f)=0,$ 那么对于任意的 $\varepsilon>0,$ 存在 $\delta>0,$  使得只要 partition 的 mesh 小于 $\delta,$ 就有
$|\mathcal U-\overline{\int}|,|\mathcal L-\underline{\int}|< \varepsilon.$ 自然，此时由不等式 \eqref{eq:Riemann_limit_mesh_upper_lower} 可知
\begin{equation}
    \underline{\int}_a^b f(x)\ \mathrm dx-\varepsilon<\mathcal L(f,\mathcal P,[a,b])\leq \mathcal R(f,\mathcal P,\Delta,[a,b])\leq \mathcal U(f,\mathcal P,[a,b])\leq \overline{\int}_a^b f(x)\ \mathrm dx+\varepsilon
\end{equation}
这就证明了极限 \eqref{eq:Riemann_limit} 的存在性.

容易验证闭区间上的连续函数是 Riemann 可积的. 这主要用到了其一致连续性.

\section{Riemann 积分的若干缺陷}

Riemann 积分的一些缺陷：
\begin{enumerate}
    \item 如果函数的连续性较差，则其 Riemann 可积性也较差：典型的例子就是 Dirichlet 函数.
    \item 无界函数的 Riemann 可积性较差(反常积分)：一个例子就是取一列可求出瑕积分的函数 $f_k(x),$ 使得每个函数的瑕点恰好对应区间 $[0,1]$ 上的一个有理数，最终导致无法通过划分区间的办法求出函数 $f:=\sum_k {f_k\over 2^k}$ 的瑕积分. 这里其实是说，
          如果将面积的次可加性推广到可数的情况，那么通常的 Riemann 积分就不太够用了. 毕竟这样构造出的 $f$ 多多少少是个较为奇怪的函数，这种例子更偏向于理论意义. 
    \item Riemann 积分与极限的可交换性较差：这个问题看起来是最为致命的. 可以构造出一列函数 $f_k,$ 它们的 Riemann 积分均为零，但其逐点收敛到 Dirichlet 函数. 虽然可以证明，如果一致有界的可积函数列的逐点极限函数是 Riemann 可积的，那么其积分与极限可以交换位置，也即 $\lim_{n} \int_a^b f_n = \int_a^b \lim_n f_n,$ 但其证明 
          却非常复杂，并且也绕不过使用测度的思想. 这个缺陷使得 Riemann 积分在理论上使用起来尤为不便. 
\end{enumerate}

\begin{example}
    定义闭区间 $[0,1]$ 上的函数 $f$ 为
    \begin{equation}
        f(x)=\begin{cases}
            0, & \text{若 $x$ 为无理数}\\
            {1\over n}, & \text{若 $x$ 为有理数，且 $n$ 为形如 $x={m\over n}$ 的表达式中的最小正整数 $n$}
        \end{cases}
    \end{equation}
    证明 $f$ 是 Riemann 可积的，并计算其积分值.
\end{example}
显然 $f$ 的每一个 Darboux 下和都为零，因此 $\underline{\int}_0^1 f = 0.$ 下面证明 $f$ Riemann 可积. 只需构造出一列 partition $\mathcal P_n,$ 使得 $\lim_n \Omega_{\mathcal P_n}(f)=0$ 即可. 由于 $\mathcal L\equiv 0,$ 因此只需证明 $\lim_n \mathcal U(f,\mathcal P_n,[0,1])=0.$
事实上，对于任意的 $n,$ 满足 $f(x)=1/n$ 的 $[0,1]$ 内的有理数至多有 $n+1$ 个，因此其数目有限. 自然，可以适当地划分区间，得到分割 $\mathcal P_n,$ 使得满足 $f(x)\geq 1/n,$ 也即 $f(x)=1,1/2,\cdots,1/n$ 的全体有理数 $x$ 所在的区间的总长不超过 $1/n.$ 自然，$f$ 在剩下的那些区间上的上确界均小于 $1/n.$ 于是就有
\begin{equation}
    \begin{aligned}
        \mathcal U(f,\mathcal P_n,[0,1])=&\sum_{\text{$f(x)\geq 1/n$ 的 $x$ 所在区间 $[x_{i-1},x_{i}]$}} \sup_{x_{i-1}\leq x\leq x_i}f(x)(x_i-x_{i-1})\\
        &+\sum_{\text{其余区间 $[x_{i-1},x_{i}]$}}\sup_{x_{i-1}\leq x\leq x_i}f(x)(x_i-x_{i-1})  \\
        <& {1\over n}-{1\over n}\left(1-{1\over n}\right) \\
        =&{2\over n}-{1\over n^2}
    \end{aligned}
\end{equation}
于是就有 $\lim_n \mathcal U(f,\mathcal P_n,[0,1])=0.$ 因此 $f$ 是 Riemann 可积的，并且其 Riemann 积分为 $\int_0^1 f=0.$


\begin{example}
    Riemann 积分与极限交换时，一致有界条件不可去掉.
\end{example}
事实上，构造单位区间 $[0,1]$ 上的连续函数列
\begin{equation}\label{eq:swap_limit_counterexample}
    f_n(x) = \begin{cases}
        n^2 x, & \text{若 $0\leq x\leq 1/n$}\\
        2n-n^2x, & \text{若 $1/n<x\leq 2/n$}\\
        0&\text{若 $x>2/n$}
    \end{cases}
\end{equation}

\begin{figure}[]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
        axis lines = middle,
        xlabel = {$x$},
        ylabel = {$f_n(x)$},
        ymin = -1, ymax = 10,
        xmin = -0.1, xmax = 1.1,
        domain = 0:1,
        samples = 100,
        grid = major,
        width=10cm,
        height=6cm,
    ]
    
    % Define n
    \def\n{3}
    
    % Plot the function
    \addplot [thick, blue, domain=0:1/\n] {(\n)^2 * x};
    \addplot [thick, blue, domain=1/\n:2/\n] {2*\n - (\n)^2 * x};
    \addplot [thick, blue, domain=2/\n:1] {0};
    
    % Add vertical lines at x = 1/n and x = 2/n
    \draw [dashed, red] (axis cs:1/\n,0) -- (axis cs:1/\n,9);
    \draw [dashed, red] (axis cs:2/\n,0) -- (axis cs:2/\n,9);
    
    % Add labels for the vertical lines
    \node [below, font=\scriptsize] at (axis cs:1/\n,0) {$\frac{1}{3}$};
    \node [below, font=\scriptsize] at (axis cs:2/\n,0) {$\frac{2}{3}$};
    
    \end{axis}
    \end{tikzpicture}
    \caption{Graph of the piecewise function \( f_n(x) \) depicted by equation \eqref{eq:swap_limit_counterexample} for \( n=3 \).}
    \label{fig:fn}
\end{figure}

那么就有 $\int_0^1 f_n = 1,$ 以及 $\lim_n f_n(x)\equiv 0.$ 这是因为 $f_n(x)$ 也就只在开区间 $(0,2/n)$ 上不为零，该区间随着 $n\to\infty$ 而消失.
因此，极限函数 $f:=\lim_n f_n$ 是连续的，并且有 $\int_0^1 f=0.$ 因此
\begin{equation}
    \lim_n \int_0^1 f_n = 1\neq 0=\int_0^1 \lim_n f_n
\end{equation}
当然，$f_n$ 不是一致有界的：$\sup_{x\in [0,1]}f_n(x)=n,$ 因此 $f_n(x)$ 不可能被某个有限的数所一致控制.


\section{外测度} 外测度的概念是经典的：对 $\mathbb R$ 的任意子集 $A,$ 都可定义其外测度 $|A|$ 为覆盖 $A$ 的开区间列的总长度之下确界，也即 $|A|=\inf_{A\subset\bigcup_n I_n} \sum_n \ell(I_n).$
这总是定义良好的. 如果某个 $\ell(I_n)$ 为 $+\infty,$ 那么显然 $\sum_n \ell(I_n)=+\infty.$ 反之，$\sum_n \ell(I_n)$ 是一个非负项的数项级数. 
自然，非负项级数要么收敛，要么发散到 $+\infty.$ 因此，如果将 $+\infty$ 也作为一个合法的长度值，
那么 $\sum_n \ell(I_n)$ 总是有定义的，并且总是大于等于零. 因此任意的实数集 $A$ 的外测度总是有定义的.

\begin{example}
    可数集的外测度为零.
\end{example}
设 $A=\{a_n\}_{n\in\mathbb N},\ \varepsilon>0,$ 那么可以构作区间列 $I_n=(a_n-\varepsilon/2^n,a_n+\varepsilon/2^n),$ 使得 $A\subset \bigcup_n I_n,$ 于是 
\begin{equation}
    |A|\leq \sum_n \ell(I_n)=\sum_n {\varepsilon\over 2^{n-1}}=2\varepsilon
\end{equation}
这就证明了 $|A|=0.$ 

特别的，有理数集 $\mathbb Q$ 的外测度为零. 这表明外测度的性质至少要比 Jordan 测度要好，因为 $\mathbb Q\cap [0,1]$ 的 Jordan 测度正是 Dirichlet 函数的 Riemann 积分，因而是不存在的.

如果实数集 $A$ 含于 $B,$ 那么任意覆盖了 $B$ 的开区间列也覆盖了 $A,$ 因而 $|A|\leq |B|.$ 因此外测度与集合的包含关系的相容性良好. 此外，由于平移变换并不改变开区间的长度，并且将开区间变为开区间，并且还是可逆的，因此任意实数集 $A$ 平移 $t$ 距离后，其外测度保持不变：$|A+t|=|A|.$ 这就是说外测度具有平移不变性.

外测度最为重要的一条性质恐怕就是次可数可加性了.
\begin{theorem}
    外测度具有次可数可加性：$|\bigcup_n A_n|\leq \sum_n |A_n|.$
\end{theorem}
首先，如果某个集合 $A_n$ 的外测度为 $+\infty,$ 那么结论显然成立. 下面假设所有 $|A_n|$ 都是有限的. 设 $\varepsilon>0.$ 对于任意固定的 $n,$ 根据外测度的定理，可以找到一列开区间 $\{I_{n,k}\}_{k\in\mathbb N},$ 使得
\begin{equation}
    \sum_k \ell(I_{n,k})<|A_n|+{\varepsilon\over 2^n}
\end{equation}
自然，记所有这些区间 $I_{n,k}$ 所做成的集合为 $X,$ 那么映射 $\mathbb N\times\mathbb N\to X,\ (n,k)\mapsto I_{n,k}$ 可以重新排列顺序为 $\mathbb N\to X,\ j\mapsto I_{n(j),k(j)}.$ 这一列区间 $I'_j:=I_{n(j),k(j)}$ 覆盖了 $\bigcup_n A_n,$ 并且对于每个正整数 $p\in\mathbb N,$ 记 $n(1),\cdots,n(p)$ 中的最大值为 $N(p),$ 则有
\begin{equation}
    \sum_{j=1}^p \ell(J_j) \leq \sum_{n=1}^{N(j)} \sum_k \ell(I_{n,k}) \leq \sum_n\sum_k \ell(I_{n,k})<\sum_n |A_n|+\varepsilon
\end{equation}
于是 $\sum_j \ell(J_j)\leq\sum_n |A_n|+\varepsilon.$ 
这就证明了 
\begin{equation}\label{eq:outer_measure_subadditivity}
    \left|\bigcup_n A_n\right|\leq \sum_n |A_n|
\end{equation}
作为一个简单推论，外测度也具有次有限可加性：$|A_1\cup\cdots\cup A_n|\leq \sum_{i=1}^n |A_i|.$ 

下面来计算有界区间的外测度. 从几何上来看，开区间 $(a,b)$ 的外测度应该就等于其长度 $b-a.$ 严格的证明稍微麻烦一些，需要借助有界闭区间的紧性. 首先，$(a,b)$ 与 $[a,b]$ 的外测度相同：$|(a,b)|\leq |[a,b]|\leq b-a,$ 并且由 $[a,b]\subset (a-\varepsilon,b+\varepsilon),$ 以及 
$|(a-\varepsilon,b+\varepsilon)|\leq |(a,b)|+2\varepsilon$ 可得 $[a,b]\leq (a,b).$ 这就证明了开区间 $(a,b)$ 的外测度与其闭包相同. 另一方面，由 $[a,b]$ 的紧性可知，任意覆盖了 $[a,b]$ 的开区间列 $I_n$ 都存在有限子覆盖 $J_1,\cdots,J_p.$ 
下面只需证明 $\sum_{i=1}^p \ell(J_i)\geq b-a$ 即可. 最简单的证法是用归纳法(\cite{Axler_2020} pp. 20). 当 $p=1$ 时结论显然成立. 假设该结论对 $p\leq k$ 成立，那么当 $p=k+1$ 时，设 $[a,b]$ 被开区间 $J_1,\cdots,J_p$ 中的某个 $J_s=(c,d)$ 所覆盖，那么若 $c\leq a,$ 则 $\ell((c,d))\geq b-a,$ 故结论成立. 
若 $c>a,$ 则闭区间 $[a,c]$ 被 $k$ 个开区间 $\{J_i\}_{1\leq i\leq p,\ i\neq s}$ 所覆盖，于是由归纳假设即知 $\sum_{i\neq s}\ell(J_i)\geq c-a.$ 于是就有 $\sum_{i=1}^p \ell(J_i)\geq (c-a)+(b-c)=b-a,$ 因此总是有 
$\sum_n \ell(I_n)\geq b-a.$ 这就证明了 $|[a,b]|=b-a,$ 因而开区间 $(a,b)$ 的外测度也等于 $b-a.$

利用区间的外测度还可以给出区间的不可数性的另一个证明.
\begin{example}
    非空区间是不可数的.
\end{example}
事实上，由于可数集的外测度为零，而非空区间的外测度都大于零，因而非空区间不可能是可数集. 这就证明了结论.

\section{外测度的缺点：不可加性} Vitali 提供了集合的不交并的外测度不等于各自外测度之和的一个例子. 
\begin{example}
    存在不交的实数集 $A$ 和 $B$，使得 $|A\cup B|\neq |A|+|B|.$
\end{example}
对于区间 $[-1,1]$ 内的任意实数 $a,$ 定义相伴的集合 $\tilde a$ 为 $[-1,1]$ 内所有与 $a$ 只相差一个有理移位的元素之全体，那么若 $\tilde a\cap\tilde b\neq \emptyset,$ 譬如说 $c\in\tilde a\cap\tilde b,$ 那么就有 
$a-c,b-c\in\mathbb Q.$ 因此 $a,b$ 本身就只相差一个有理移位. 因此对于任意实数来说，与 $a$ 的距离为有理数当且仅当与 $b$ 的距离为有理数，从而有 $\tilde a=\tilde b.$ 
自然，由 $a\in\tilde a$ 可知 $[-1,1]\subset \bigcup_{a\in [-1,1]}\tilde a.$ 

\nocite{*}
\bibliographystyle{plain}
\bibliography{../Ref/reference.bib}

\end{document}
